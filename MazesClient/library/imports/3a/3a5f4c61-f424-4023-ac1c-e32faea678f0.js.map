{"version":3,"sources":["..\\..\\..\\..\\..\\..\\assets\\Script\\UI\\Game/assets\\Script\\UI\\Game\\GameView.js"],"names":["Utils","require","HexCell","Role","Enemy","Tower","colors","hexTileHeight","sideLength","cc","Class","extends","Component","properties","invAgain","default","type","Node","mission","gm","title","Label","star1","star2","star3","moves","RichText","best","tileBox","iceBox","maxValidMoves","Integer","movesLeft","moved","levelDimensions","v2","visible","gridOffset","hexCellPrefab","icePrefab","rolePrefab","enemyPrefab","enemyPrefab1","enemyPrefab2","endPrefab","allCells","allTowers","myRole","enemys","helplines","endObj","selectedLines","mouseIsDown","userInputEnabled","gameOver","prevTilePosition","mouseOffsetPos","touchPos","movePlus","get","helpPath","helpShaked","helpBtn","helpCountLabel","_helpCount","helpCount","set","v","string","toString","param","SDK","setScore","getChildByName","active","timeHelpBtn","timeHelpCountLabel","_timeHelpCount","timeHelpCount","replayCountLabel","_replayCount","replayTimeCount","replayCount","watchVideoTip","shareFriendTip","preBtn","nextBtn","endView","endView_nextBtn","endView_backBtn","endView_Stars","endView_title","endView_text","gameApplication","Object","isMoving","lastDirection","turnBackCount","timesNode","timesVal","timesLeft","timeOutflowCB","timeIsUpNode","timeIsUpInvNode","timeIsUpEndNode","gotMoreTime","goShareView","musicBtn","Sprite","menuView","isMemu","musicOn","SpriteFrame","musicOff","guideView","checkMusic","event","isDis","soundManager","isOpen","setIsOpen","spriteFrame","menuShow","isShow","PopGameView","onLoad","window","gameView","plusMoreHelp","plusHelp","clearHelp","onEnable","getScore","count","bind","val","undefined","isFirst","gameFirst","clearData","start","gameApplicationNode","find","getComponent","onBackBtnClicked","isGM","scheduleOnce","init","node","on","EventType","TOUCH_START","onMouseDown","TOUCH_MOVE","onMouseMove","clear","unschedule","timeOutflow","clearTile","splice","length","currentLineColor","oldCurrentLineColor","childrenCount","i","n","children","destroy","self","bid","mid","lid","path","getConf","results","initGame","arr","push","forEach","tmp_lid","tmp_path","initHelpBtn","lines","linesCount","levelInfo","grid","createGrid","levelDetail","level","DataAnalytics","levelBegin","gameTimes","createRole","enemy","createEnemy","initHelpPath","cloneObj","t","interval","repeat","delay","schedule","playTimes","updateUI","log","axialCoordinate","test","checkXY","canMovePath","checkMovePos","j","testV2","x","y","getMoreTimeBtn","playSound","color","hexToColor","stopAllAction","getMoreTime","target","Button","interactable","doEvent","showVideoAd","isCompleted","getMoreTimeInv","score","share","showInvAgain","restarGame","stopAllActions","nextGame","prevGame","help","helpStart","helpIdx","tmpPath","selected","equals","showHelpLine","startV2","isNeighbors","isContinue","hc","getCellByCoordinate","canMove","checkCanMoveCount","checkMove","isIce","tmp_coordinate","showStartHelp","showEndHelp","showHelp","itemDetail","itemID","itemType","itemCount","reason","dealItem","update","dt","roundMove","tower","towerShoot","isShooting","bubble","bubbleAxialCoordinate","direction","cb1","callFunc","play","delay0","delayTime","cb2","position","pCompMult","getPosition","opacity","cb4","seq","sequence","runAction","scale","nextPos","add","worldPosition","convertToWorldSpaceAR","hcPos_tmp","convertToNodeSpaceAR","hcPos","a1","moveTo","checkMoveDirectionCount","Math","random","idx","GetRandomNum","getLocation","movePos","offsetX","offsetY","abs","doAction","_coordinate","die","playDie","showGameOver","levelResult","curr_star","star","plusStar","all","checkWin","isWin","moveEnd","inArray","helpBtnShake","setArrow","addSelectedLines","coordinate","pop","hideLine","showStartLine","showEndLine","showLine","manual","hideArrow","isTurnBack","getkMoveDirection","c","neighbors","getNeighborsOBJ","l","d","r","leftActive","rightActive","topActive","bottomActive","tc","dc","b","lc","rc","enemy_GO","instantiate","parent","setScale","setPosition","end","hc1","role_GO","role","end_GO","endNode","setDark","collisionCallback","_levelDimensions","walls","ices","towers","cb","maxL","max","winSize","director","getWinSize","tileBoxSize","getContentSize","tileBoxHeight","height","hexH","width","lineWidth","nowHeight","testHexTileHeight","sizeW","sizeH","hexTile","axialPoint","screenPoint","axialToScreen","setContentSize","size","name","zIndex","scaleChild","wx","wy","dx","dy","wall","tmp_w1","tmp_d1","w1","d1","setLeft","setTop","setRight","setBottom","ice","setIce","iceNode","scaleTo","min","setRightTower","pushTower","rightTower","setLeftTower","leftTower","setTopTower","topTower","setBottomTower","bottomTower","config","dict","setStar","f","btn","loadScene","onNextBtnClicked","onPreviousBtnClicked","onReStarBtnClicked","onHelpBtnClicked","onWatchVideoBtnClicked","onShareInvBtnClicked","console","onShareBtnClicked","onCloseWatchVideoTipClicked","closeSelf","goShare","shake"],"mappings":"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","file":"GameView.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\Script\\UI\\Game","sourcesContent":["var Utils = require(\"../../Utils/Utils\");\r\nvar HexCell = require(\"./HexCell\");\r\nvar Role = require(\"./Role\");\r\nvar Enemy = require(\"./Enemy\");\r\nvar Tower = require(\"./Tower\");\r\n\r\nvar colors = [\r\n    \"#5d3eaf\",\r\n    \"#4ba3e8\",\r\n    \"#9d9e9d\",\r\n    \"#67798a\",\r\n    \"#f19b38\"\r\n];\r\n\r\n\r\nvar hexTileHeight = 100;    //actually the width of the hex tile graphic (distance between the pointy opposite corners)\r\nvar sideLength; //this is the lendth of one side of the hexagon or the length of a corner to centre of the hexagon\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        invAgain: {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        mission: {\r\n            default: null,\r\n        },\r\n        gm: {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        title: {\r\n            default: null,\r\n            type: cc.Label,\r\n        },\r\n        star1: {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        star2: {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        star3: {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        moves: {\r\n            default: null,\r\n            type: cc.RichText,\r\n        },\r\n        best: {\r\n            default: null,\r\n            type: cc.RichText,\r\n        },\r\n        tileBox: {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        iceBox: {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        maxValidMoves: {\r\n            default: 0,\r\n            type: cc.Integer,\r\n        },\r\n        movesLeft: {\r\n            default: 0,\r\n            type: cc.Integer,\r\n        },\r\n        moved: {\r\n            default: 0,\r\n            type: cc.Integer,\r\n        },\r\n        //grid size colum x row\r\n        levelDimensions: {\r\n            default: cc.v2(0, 0),\r\n            visible: false,\r\n        },\r\n        //position of the full grid\r\n        gridOffset: {\r\n            default: cc.v2(0, 0),\r\n            visible: false,\r\n        },\r\n        hexCellPrefab: {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        icePrefab: {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        rolePrefab: {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        enemyPrefab: {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        enemyPrefab1: {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        enemyPrefab2: {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        endPrefab: {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        //list of all the cells in the grid\r\n        allCells: {\r\n            default: [],\r\n            type: [HexCell],\r\n        },\r\n        allTowers: {\r\n            default: [],\r\n            type: [Tower],\r\n        },\r\n        myRole: {\r\n            default: null,\r\n            type: Role,\r\n        },\r\n        enemys: {\r\n            default: []\r\n        },\r\n        helplines: {\r\n            default: []\r\n        },\r\n        endObj: {\r\n            default: null,\r\n            type: Role,\r\n        },\r\n\r\n        selectedLines: {\r\n            default: [],\r\n        },\r\n\r\n        mouseIsDown: false,\r\n        userInputEnabled: false,\r\n        gameOver: false,\r\n\r\n        prevTilePosition: {\r\n            default: cc.v2(-1000, -1000),\r\n            visible: false,\r\n        },\r\n        mouseOffsetPos: {\r\n            default: cc.v2(0, 0),\r\n            visible: false,\r\n        },\r\n        touchPos: {\r\n            default: cc.v2(0, 0),\r\n            visible: false,\r\n        },\r\n\r\n        movePlus: {\r\n            get: function () {\r\n                //t,l,d,r\r\n                return [\r\n                    cc.v2(0, 1), //top\r\n                    cc.v2(-1, 0), //left\r\n                    cc.v2(0, -1), //down\r\n                    cc.v2(1, 0)  //right\r\n                ];\r\n            }\r\n        },\r\n\r\n        helpPath: {\r\n            default: [],\r\n        },\r\n        helpShaked: {\r\n            default: [],\r\n        },\r\n\r\n        helpBtn: {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        helpCountLabel: {\r\n            default: null,\r\n            type: cc.Label,\r\n        },\r\n        _helpCount: {\r\n            default: 0,\r\n            type: cc.Integer,\r\n        },\r\n        helpCount: {\r\n            get: function () {\r\n                return this._helpCount;\r\n            },\r\n            set: function (v) {\r\n                this._helpCount = v;\r\n                this.helpCountLabel.string = v.toString();\r\n\r\n                var param = {};\r\n                param[\"my_help\"] = this._helpCount > 0 ? this._helpCount : -1;\r\n                SDK().setScore(param, null);\r\n\r\n                this.helpBtn.getChildByName(\"icon\").active = true;\r\n                this.helpBtn.getChildByName(\"num\").active = true;\r\n            },\r\n        },\r\n\r\n        //时间帮助按钮\r\n        timeHelpBtn: {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        timeHelpCountLabel: {\r\n            default: null,\r\n            type: cc.Label,\r\n        },\r\n        _timeHelpCount: {\r\n            default: 0,\r\n            type: cc.Integer,\r\n        },\r\n        timeHelpCount: {\r\n            get: function () {\r\n                return this._timeHelpCount;\r\n            },\r\n            set: function (v) {\r\n                this._timeHelpCount = v;\r\n                this.timeHelpCountLabel.string = v.toString();\r\n\r\n                var param = {};\r\n                param[\"timeHelp\"] = this._timeHelpCount;\r\n                SDK().setScore(param, null);\r\n            },\r\n        },\r\n\r\n        //重玩消耗\r\n        replayCountLabel: {\r\n            default: null,\r\n            type: cc.Label,\r\n        },\r\n        _replayCount: {\r\n            default: 0,\r\n            type: cc.Integer,\r\n        },\r\n        replayTimeCount: {\r\n            get: function () {\r\n                return this._replayCount;\r\n            },\r\n            set: function (v) {\r\n                this.replayCount = v;\r\n                this.replayCountLabel.string = v.toString();\r\n                var param = {};\r\n                param[\"replayCount\"] = this._timeHelpCount;\r\n                SDK().setScore(param, null);\r\n            },\r\n        },\r\n\r\n        watchVideoTip: {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        shareFriendTip: {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        preBtn: {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        nextBtn: {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        endView: {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        endView_nextBtn: {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        endView_backBtn: {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        endView_Stars: {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        endView_title: {\r\n            default: null,\r\n            type: cc.Label,\r\n        },\r\n        endView_text: {\r\n            default: null,\r\n            type: cc.RichText,\r\n        },\r\n        gameApplication: {\r\n            default: null,\r\n            type: Object\r\n        },\r\n        isMoving: false,\r\n        //最后行走方向\r\n        lastDirection: {\r\n            default: -1,\r\n            type: cc.Integer,\r\n        },\r\n        turnBackCount: {\r\n            default: 0,\r\n            type: cc.Integer,\r\n        },\r\n        timesNode: {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        timesVal: {\r\n            default: null,\r\n            type: cc.Label,\r\n        },\r\n        timesLeft: {\r\n            default: 0,\r\n            type: cc.Integer,\r\n        },\r\n        timeOutflowCB: {\r\n            default: null\r\n        },\r\n        timeIsUpNode: {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        timeIsUpInvNode: {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        timeIsUpEndNode: {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        gotMoreTime: false,\r\n\r\n        goShareView: {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n\r\n        musicBtn: {\r\n            default: null,\r\n            type: cc.Sprite,\r\n        },\r\n\r\n        menuView: {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n\r\n        isMemu: {\r\n            default: false,\r\n            visible: false,\r\n        },\r\n        musicOn:{\r\n            default: null,\r\n            type: cc.SpriteFrame,\r\n        },\r\n        musicOff:{\r\n            default: null,\r\n            type: cc.SpriteFrame,\r\n        },\r\n\r\n        guideView:{\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n    },\r\n\r\n    checkMusic(event, isDis) {\r\n        if (isDis == \"turn\") {\r\n            if (gameApplication.soundManager.isOpen) {\r\n                gameApplication.soundManager.setIsOpen(false);\r\n            } else {\r\n                gameApplication.soundManager.setIsOpen(true);\r\n            }\r\n        }\r\n        if (gameApplication.soundManager.isOpen) {\r\n            this.musicBtn.spriteFrame = this.musicOn;\r\n        } else {\r\n            this.musicBtn.spriteFrame = this.musicOff;\r\n        }\r\n    },\r\n\r\n    menuShow(event, isShow) {\r\n        if (isShow == \"1\") {\r\n            this.menuView.active = true;\r\n            this.isMemu = true;\r\n            gameApplication.PopGameView.active = true;\r\n        } else if (isShow == \"2\") {\r\n            this.menuView.active = false;\r\n            this.isMemu = false;\r\n            gameApplication.PopGameView.active = false;\r\n        }\r\n    },\r\n\r\n    onLoad: function () {\r\n        window.gameView = this;\r\n    },\r\n\r\n    plusMoreHelp() {\r\n        this.helpCount += plusHelp;\r\n    },\r\n\r\n    clearHelp() {\r\n        this.helpCount = 0;\r\n    },\r\n\r\n    onEnable() {\r\n        SDK().getScore(\"timeHelp\", function (count) {\r\n            this.timeHelpCount = count;\r\n            //this.timeHelpCountLabel.string = count;\r\n        }.bind(this));\r\n\r\n        SDK().getScore(\"replayCount\", function (count) {\r\n            this.replayTimeCount = count;\r\n            //this.replayCountLabel.string = count;\r\n        }.bind(this));\r\n\r\n        SDK().getScore(\"isFirst\",function(val){\r\n            if(val == 0|| val == null || val == undefined){\r\n                SDK().setScore({isFirst:1});\r\n            }else{\r\n                if(window.gameFirst){\r\n                    this.goShareView.active = true;\r\n                    window.gameFirst = false;\r\n                }\r\n            }\r\n        }.bind(this))\r\n    },\r\n\r\n    clearData() {\r\n        SDK().clearData();\r\n    },\r\n\r\n    start() {\r\n        var gameApplicationNode = cc.find(\"GameApplication\");\r\n        if (gameApplicationNode != null) {\r\n            this.gameApplication = gameApplicationNode.getComponent(\"GameApplication\");\r\n        }\r\n\r\n        if (typeof this.gameApplication === 'undefined' || this.gameApplication == null) {\r\n            this.onBackBtnClicked();\r\n            return;\r\n        }\r\n\r\n        this.gm.active = SDK().isGM()\r\n\r\n        this.scheduleOnce(function () {\r\n            this.init();\r\n        }, 0.2)\r\n\r\n        this.node.on(cc.Node.EventType.TOUCH_START, function (event) {\r\n            this.onMouseDown(event);\r\n        }, this);\r\n\r\n        this.node.on(cc.Node.EventType.TOUCH_MOVE, function (event) {\r\n            this.onMouseMove(event);\r\n        }, this);\r\n\r\n        // this.node.on(cc.Node.EventType.TOUCH_END, function (event) {\r\n        //     this.onMouseUp(event);\r\n        // }, this);\r\n\r\n        // this.node.on(cc.Node.EventType.TOUCH_CANCEL, function (event) {\r\n        //     this.onMouseUp(event);\r\n        // }, this);\r\n    },\r\n\r\n    clear() {\r\n\r\n        this.unschedule(this.timeOutflow);\r\n\r\n        this.clearTile();\r\n\r\n        this.allCells.splice(0, this.allCells.length);\r\n        this.allTowers.splice(0, this.allTowers.length);\r\n        this.selectedLines.splice(0, this.selectedLines.length);\r\n        this.enemys.splice(0, this.enemys.length);\r\n        this.helplines.splice(0, this.helplines.length);\r\n        this.myRole = null;\r\n        this.helpShaked.splice(0, this.helpShaked.length);\r\n\r\n        if (this.helpPath != null && this.helpPath.length > 0) {\r\n            this.helpPath.splice(0, this.helpPath.length);\r\n        }\r\n\r\n        // Xuanyou.Util.DestroyAllChilds (tileBox);\r\n\r\n        hexTileHeight = 100;\r\n        this.mouseIsDown = false;\r\n        this.gameOver = false;\r\n        this.movesLeft = 0;\r\n        this.moved = 0;\r\n        this.turnBackCount = 0;\r\n        this.lastDirection = -1;\r\n        this.isMoving = false;\r\n\r\n        // this.filling = 0;\r\n        // this.filling_str = \"0\";\r\n        this.currentLineColor = 0;\r\n        this.oldCurrentLineColor = 0;\r\n\r\n        // this.m_Num = 0;\r\n        // this.m_tweenNum = 0;\r\n    },\r\n\r\n    clearTile() {\r\n        // cc.log(\"this.tileBox.childrenCount:\"+this.tileBox.childrenCount)\r\n        if (this.tileBox.childrenCount > 0) {\r\n            //如果有child，destroy\r\n            for (var i = 0; i < this.tileBox.childrenCount; i++) {\r\n                var n = this.tileBox.children[i];\r\n                if (n != null) {\r\n                    n.active = false;\r\n                    n.destroy();\r\n                }\r\n            }\r\n        }\r\n\r\n        if (this.iceBox.childrenCount > 0) {\r\n            //如果有child，destroy\r\n            for (var i = 0; i < this.iceBox.childrenCount; i++) {\r\n                var n = this.iceBox.children[i];\r\n                if (n != null) {\r\n                    n.active = false;\r\n                    n.destroy();\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n\r\n    init() {\r\n        // cc.log(\"____________________conf/level_detail/b_\"+bid+\"/\"+mid+\"/\"+lid+\".json\");\r\n\r\n        var self = this;\r\n        this.selectedLines = [];\r\n        this.enemys = [];\r\n        this.helplines = [];\r\n        this.helpPath = [];\r\n        this.myRole = null;\r\n        this.isMoving = false;\r\n\r\n        this.endView.active = false;\r\n        this.timeIsUpNode.active = false;\r\n        this.gotMoreTime = false;\r\n        if (bid != null && bid > 0 && mid != null && mid > 0 && lid != null && lid > 0) {\r\n            var path = \"conf/level_detail/b_\" + bid + \"/\" + mid + \"/\" + lid;\r\n            this.gameApplication.getConf(path, function (results) {\r\n                this.mission = results;\r\n                // cc.log(\"this.mission:\",this.mission);\r\n                this.initGame();\r\n            }.bind(this));\r\n\r\n            //预加载上下两关\r\n            var arr = [];\r\n            if (lid > 1) {\r\n                arr.push(lid - 1);\r\n            }\r\n            if (lid < 100) {\r\n                arr.push(lid + 1);\r\n            }\r\n            arr.forEach(function (tmp_lid) {\r\n                var tmp_path = \"conf/level_detail/b_\" + bid + \"/\" + mid + \"/\" + tmp_lid;\r\n                // cc.log(\"tmp_path:\",tmp_path);\r\n                self.gameApplication.getConf(tmp_path, null);\r\n            });\r\n\r\n            //init HelpBtn\r\n            this.initHelpBtn();\r\n\r\n        } else {\r\n            this.onBackBtnClicked();\r\n        }\r\n    },\r\n\r\n    initHelpBtn() {\r\n        var self = this;\r\n        SDK().getScore(\"my_help\", function (count) {\r\n            if (count == 0) {\r\n                self.helpCount = 5;\r\n                self.guideView.active = true;\r\n            } else if (count == -1) {\r\n                self.helpCount = 0;\r\n            } else {\r\n                self.helpCount = count;\r\n            }\r\n        }.bind(this));\r\n    },\r\n\r\n    initGame() {\r\n        this.timeIsUpNode.active = false;\r\n        this.timeIsUpInvNode.active = false;\r\n        this.timeIsUpEndNode.active = false;\r\n        this.gotMoreTime = false;\r\n        this.endView.active = false;\r\n        this.clear();\r\n\r\n        // cc.log(\"this.mission:\",this.mission)\r\n\r\n        var lines = this.mission['lines'];\r\n        var linesCount = lines.length;\r\n\r\n        this.maxValidMoves = linesCount;\r\n        this.movesLeft = linesCount;\r\n        this.moved = 0;\r\n        this.turnBackCount = 0;\r\n        this.helpShaked.splice(0, this.helpShaked.length);\r\n\r\n        this.lastDirection = -1;\r\n\r\n\r\n        var path = \"conf/level_list/level_\" + bid + '_' + mid;\r\n        this.gameApplication.getConf(path, function (results) {\r\n            var levelInfo = results;\r\n            this.title.string = levelInfo['title'] + \" \" + lid;\r\n        }.bind(this));\r\n\r\n\r\n        // this.moves.string = \"<color=#ff0000>0</c>/\"+this.mission['moves'];\r\n        this.moves.string = \"0/\" + linesCount;\r\n\r\n\r\n\r\n        //判断是否有上一关\r\n        /* this.preBtn.active = lid > 1;\r\n        this.nextBtn.active = false; */\r\n\r\n        //最好成绩\r\n        SDK().getScore(bid + \"_\" + mid + \"_\" + lid + \"_moves\", function (best) {\r\n            if (best <= 0) {\r\n                this.best.string = \"-\";\r\n            } else {\r\n                this.best.string = best.toString();\r\n            }\r\n            /* this.nextBtn.active = (lid < 100 && best > 0) || openAllLevel; */\r\n        }.bind(this));\r\n\r\n\r\n\r\n\r\n        //初始化格子\r\n        var grid = cc.v2(this.mission['x'], this.mission['y']);\r\n        this.createGrid(grid, this.mission[\"walls\"], this.mission[\"ice\"], this.mission[\"tower\"], function () {\r\n            this.scheduleOnce(function () {\r\n                var levelDetail = {};\r\n                levelDetail.level = mid + \"0\" + (lid > 99 ? lid : (lid > 9 ? \"0\" + lid : \"00\" + lid));\r\n                gameApplication.DataAnalytics.levelBegin(levelDetail);\r\n\r\n                this.isMemu = true;\r\n                window.gameTimes = window.gameTimes + 1;\r\n                if (window.gameTimes == 10) {\r\n                    window.gameTimes = 0;\r\n                    this.goShareView.active = true;\r\n                }\r\n                //处理第一次进游戏\r\n                //保存当前关\r\n                var param = {};\r\n                param[\"playingMid\"] = mid;\r\n                param[\"playingLid\"] = lid;\r\n                SDK().setScore(param, null);\r\n\r\n                //初始化球的位置\r\n                this.createRole(this.mission['start'], this.mission['end']);\r\n\r\n                var enemy = this.mission['enemy'];\r\n                if (enemy.length > 0) {\r\n                    this.createEnemy(this.mission['enemy']);\r\n                }\r\n\r\n                //help\r\n                // cc.log(\"_________-this.mission\",this.mission[\"lines\"]);\r\n                this.initHelpPath(Utils.cloneObj(this.mission[\"lines\"]));\r\n\r\n\r\n                //初始化时间模式\r\n                if (mid == 6) {\r\n                    // cc.log(\"初始化时间模式\")\r\n                    this.timeHelpBtn.active = true;\r\n                    var t = 12;\r\n                    if (lid <= 5) {\r\n                        t = 12;\r\n                    } else if (lid <= 20) {\r\n                        t = 15;\r\n                    } else if (lid <= 45) {\r\n                        t = 20;\r\n                    } else if (lid <= 75) {\r\n                        t = 25;\r\n                    } else {\r\n                        t = 30;\r\n                    }\r\n\r\n                    this.timesLeft = t;\r\n                    this.timesNode.active = true;\r\n                    this.timesVal.string = t.toString()\r\n\r\n                    var interval = 1;\r\n                    var repeat = t + 10000;\r\n                    var delay = 1;\r\n\r\n                    this.schedule(this.timeOutflow, interval, repeat, delay);\r\n                } else {\r\n                    this.timesLeft = -1;\r\n                    this.timeHelpBtn.active = false;\r\n                }\r\n\r\n                this.gameApplication.playTimes++;\r\n            }.bind(this), 0.5)\r\n        }.bind(this));\r\n\r\n\r\n\r\n\r\n        //初始化终点位置\r\n        // //格子小于5的，显示帮助。\r\n        // this.helpTip.active = mid <= 2 && this.mission['x'] <= 5;\r\n\r\n\r\n\r\n        this.updateUI();\r\n\r\n    },\r\n\r\n    initHelpPath(helpPath) {\r\n        // cc.log(\"initHelpPath:\",helpPath);\r\n        // this.helpPath = helpPath;\r\n        // cc.log(\"+++++++++++==mid:\",mid)\r\n        if (mid != 2 && mid != 4 && mid != 6) {\r\n\r\n            this.helpPath = helpPath;\r\n            //cc.log(\"______\",this.helpPath)\r\n        } else {\r\n            cc.log(\"_______________\")\r\n            this.helpPath = [];\r\n            this.helpPath.push(this.myRole.axialCoordinate);\r\n\r\n            var test = 0;\r\n            while (helpPath.length > 0) {\r\n                for (var i = 0; i < helpPath.length; i++) {\r\n                    var path = helpPath[i];\r\n                    // cc.log(\"_____check:\",path);\r\n\r\n                    if (path != null) {\r\n                        path = this.checkXY(path, 0, 0);\r\n                        var canMovePath = this.checkMovePos(path);\r\n                        // cc.log(\"canMovePath:\",canMovePath);\r\n                        // cc.log(\"this.helpPath[this.helpPath.length-1]:\",this.helpPath[this.helpPath.length-1]);\r\n                        for (var j = 0; j < canMovePath.length; j++) {\r\n\r\n                            var testV2 = this.helpPath[this.helpPath.length - 1];\r\n                            if (canMovePath[j].x == testV2.x && canMovePath[j].y == testV2.y) {\r\n                                this.helpPath.push(helpPath[i]);\r\n                                helpPath.splice(i, 1)\r\n                                break;\r\n                            }\r\n                        }\r\n                    }\r\n\r\n\r\n                }\r\n                test++;\r\n\r\n                if (test >= 500) {\r\n                    // cc.log(\"helpPath:\",JSON.stringify(helpPath));\r\n                    helpPath.splice(0, helpPath.length);\r\n                    helpPath = [];\r\n                }\r\n            }\r\n        }\r\n\r\n\r\n\r\n        // cc.log(\"____________this.helpPath:\",this.helpPath);\r\n\r\n\r\n    },\r\n\r\n\r\n    getMoreTimeBtn() {\r\n        if (this.timeHelpCount > 0) {\r\n            this.timesLeft = this.timesLeft + 5\r\n            this.timeHelpCount = this.timeHelpCount - 1;\r\n        } else {\r\n            this.timeIsUpNode.active = true;\r\n        }\r\n    },\r\n\r\n    timeOutflow() {\r\n        //时间模式\r\n        // cc.log(\"时间模式:\",this.timesLeft)\r\n        var self = this;\r\n        if (this.timesLeft > 0) {\r\n            if(!this.isMemu&&!this.timeIsUpNode.active&&!this.watchVideoTip.active){\r\n                this.timesLeft--;\r\n            }\r\n            if (this.timesLeft < 10 && this.timesLeft > 1) {\r\n                this.schedule(function () {\r\n                    self.gameApplication.soundManager.playSound(\"clock\");\r\n                }, 0.5, 2, 0);\r\n            }\r\n\r\n            this.timesNode.active = true;\r\n            this.timesVal.string = this.timesLeft.toString();\r\n            if (this.timesLeft < 10) {\r\n                this.timesVal.node.color = cc.hexToColor(\"#ef3a40\");\r\n            } else {\r\n                this.timesVal.node.color = cc.hexToColor(\"#ffffff\");\r\n            }\r\n\r\n            if (this.timesLeft == 0) {\r\n                this.gameOver = true;\r\n                this.timeIsUpEndNode.active = true;\r\n\r\n                self.unschedule(this.timeOutflow);\r\n                this.stopAllAction();\r\n            }\r\n        }\r\n    },\r\n\r\n    getMoreTime(event) {\r\n        event.target.getComponent(cc.Button).interactable = false;\r\n\r\n        var self = this;\r\n        gameApplication.DataAnalytics.doEvent(\"看视频获得更多时间\");\r\n        SDK().showVideoAd(function (isCompleted) {\r\n            if (isCompleted) {\r\n                gameApplication.DataAnalytics.doEvent(\"播放视频广告成功\");\r\n                self.timeHelpCount = self.timeHelpCount + 5;\r\n            } else {\r\n                gameApplication.DataAnalytics.doEvent(\"播放视频广告失败\");\r\n                // cc.log(\"播放视频广告失败\")\r\n            }\r\n            event.target.getComponent(cc.Button).interactable = true;\r\n            self.timeIsUpNode.active = false;\r\n\r\n        }.bind(this));\r\n    },\r\n\r\n    getMoreTimeInv(event) {\r\n        var self = this;\r\n        SDK().getScore(\"all\", function (score) {\r\n            gameApplication.DataAnalytics.doEvent(\"分享获得更多时间\");\r\n            SDK().share(score, function (isCompleted) {\r\n                if (isCompleted) {\r\n                    self.timesLeft = 10;\r\n                    self.timesNode.active = true;\r\n                    self.timesVal.string = \"10\"\r\n\r\n                    var interval = 1;\r\n                    var repeat = 10;\r\n                    var delay = 1;\r\n\r\n                    self.gotMoreTime = true;\r\n                    self.gameOver = false;\r\n                    self.unschedule(this.timeOutflow);\r\n                    self.schedule(self.timeOutflow, interval, repeat, delay);\r\n                } else {\r\n                    self.showInvAgain(3, event);\r\n                }\r\n                event.target.getComponent(cc.Button).interactable = true;\r\n                self.timeIsUpInvNode.active = false;\r\n            }.bind(this));\r\n        }.bind(this));\r\n    },\r\n\r\n\r\n\r\n    restarGame(delay) {\r\n        this.myRole.node.stopAllActions();\r\n        this.unschedule(this.timeOutflow);\r\n        this.timesVal.node.color = cc.hexToColor(\"#ffffff\");\r\n\r\n        this.timeIsUpNode.active = false;\r\n        this.gotMoreTime = false;\r\n        this.endView.active = false;\r\n        this.selectedLines.splice(0, this.selectedLines.length);\r\n        this.enemys.splice(0, this.enemys.length);\r\n        this.helplines.splice(0, this.helplines.length);\r\n        this.helpPath.splice(0, this.helpPath.length);\r\n        this.helpShaked.splice(0, this.helpShaked.length);\r\n        this.isMoving = false;\r\n\r\n\r\n        //清除当前数据\r\n        this.movesLeft = this.maxValidMoves;\r\n        this.moved = 0;\r\n        this.turnBackCount = 0;\r\n\r\n        this.lastDirection = -1;\r\n\r\n        if (delay != null && delay > 0) {\r\n            this.scheduleOnce(function () {\r\n                this.gameOver = false;\r\n                this.myRole = null;\r\n                this.initGame();\r\n            }, delay)\r\n        } else {\r\n            this.gameOver = false;\r\n            this.myRole = null;\r\n            this.initGame();\r\n        }\r\n\r\n    },\r\n\r\n    nextGame() {\r\n        if (lid < 100) {\r\n            //如果当前大关还有关卡，那么进入。\r\n            lid++;\r\n            this.init();\r\n        } else {\r\n            //返回\r\n            this.onBackBtnClicked();\r\n        }\r\n    },\r\n\r\n    prevGame() {\r\n        if (lid > 1) {\r\n            lid--;\r\n            this.init();\r\n        } else {\r\n            this.onBackBtnClicked();\r\n        }\r\n    },\r\n\r\n    help() {\r\n        if (this.gameOver || this.myRole == null) {\r\n            return;\r\n        }\r\n        //判断已走的路径有没有途径点（找到起点）\r\n        if (this.helpPath.length <= 0) {\r\n            return;\r\n        }\r\n\r\n        var helpStart = null;\r\n        var helpIdx = 0;\r\n        if (this.selectedLines.length > 0) {\r\n            for (var i = this.helpPath.length - 1; i >= 0; i--) {\r\n                var tmpPath = this.checkXY(this.helpPath[i], 0, 0);\r\n                var path = cc.v2(tmpPath.x, tmpPath.y);\r\n                for (var j = this.selectedLines.length - 1; j >= 0; j--) {\r\n                    var selected = this.selectedLines[j];\r\n                    if (helpStart == null && path.equals(selected)) {\r\n                        helpStart = path;\r\n                        helpIdx = i;\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        // cc.log(\"helpStart:\",helpStart)\r\n        if (helpStart == null) {\r\n            helpStart = this.checkXY(this.helpPath[0], 0, 0);\r\n            helpIdx = 0;\r\n        }\r\n        // cc.log(\"helpStart:\",helpStart)\r\n\r\n        this.showHelpLine(helpStart, helpIdx);\r\n    },\r\n\r\n    showHelpLine(helpStart, helpIdx) {\r\n        if (this.helpPath.length <= 0) {\r\n            return;\r\n        }\r\n        // cc.log(\"helpIdx:\",helpIdx);\r\n\r\n        var self = this;\r\n\r\n        var startV2 = cc.v2(helpStart.x, helpStart.y);\r\n        // cc.log(\"startV2:\",startV2);\r\n        if (this.helplines.length > 0) {\r\n            startV2 = this.helplines[this.helplines.length - 1];\r\n        }\r\n\r\n        //如果startV2已经在heleLines里了，那么从helpLines最后一个节点开始\r\n        // for(var i = this.helpPath.length-1;i >= 0;i--){\r\n        for (var i = 0; i < this.helpPath.length; i++) {\r\n            var v2 = this.helpPath[i];\r\n            // cc.log(\"__v2:\",v2)\r\n            if (startV2.equals(v2)) {\r\n                startV2 = cc.v2(v2.x, v2.y);\r\n                helpIdx = i;\r\n                // cc.log(\"edit_startV2:\",startV2);\r\n                // cc.log(\"__helpIdx:\",helpIdx);\r\n                break;\r\n            }\r\n        }\r\n        // cc.log(\"this.helpPath.length-1:\",this.helpPath.length-1)\r\n        if (helpIdx < this.helpPath.length - 1) {\r\n            this.helpCount--;\r\n        }\r\n\r\n\r\n        // var helplines = [];\r\n\r\n        if (this.helplines.length <= 0) {\r\n            if (!startV2.equals(this.myRole.axialCoordinate) && Utils.isNeighbors(startV2, this.myRole.axialCoordinate)) {\r\n                self.helplines.push(cc.v2(this.myRole.axialCoordinate.x, this.myRole.axialCoordinate.y));\r\n            }\r\n            self.helplines.push(cc.v2(startV2.x, startV2.y));\r\n            // cc.log(\"__self.helplines:\",self.helplines);\r\n        }\r\n\r\n        //获得路线\r\n        var isContinue = true;\r\n        while (++helpIdx < this.helpPath.length && isContinue) {\r\n            helpStart = this.checkXY(this.helpPath[helpIdx], 0, 0);\r\n            self.helplines.push(cc.v2(helpStart.x, helpStart.y));\r\n            var hc = self.getCellByCoordinate(helpStart);\r\n            var canMove = this.checkCanMoveCount(this.checkMove(helpStart));\r\n            if (canMove > 2 && self.helplines.length > 1 && self.helplines.length > self.selectedLines.length && !hc.isIce) {\r\n                isContinue = false;\r\n            }\r\n        }\r\n\r\n        // cc.log(\"self.helplines:\",self.helplines);\r\n        //绘制路线\r\n        if (self.helplines.length > 1) {\r\n\r\n            // for(var i = 0;i < this.allCells.length;i++){\r\n            //     var hc = this.allCells[i];\r\n            //     hc.hideHelpLine();\r\n            // }\r\n\r\n            for (var i = 0; i < self.helplines.length; i++) {\r\n                var tmp_coordinate = self.helplines[i];\r\n                var hc = self.getCellByCoordinate(tmp_coordinate);\r\n                if (i == 0) {\r\n                    hc.showStartHelp(self.helplines[i + 1]);\r\n                } else if (i == self.helplines.length - 1) {\r\n                    hc.showEndHelp(self.helplines[self.helplines.length - 2]);\r\n                } else {\r\n                    hc.showHelp(self.helplines[i - 1], self.helplines[i + 1]);\r\n                }\r\n            }\r\n        }\r\n\r\n        // cc.log(\"self.helplines:\",self.helplines);\r\n        var itemDetail = {};\r\n        itemDetail.itemID = \"提示\";\r\n        itemDetail.itemType = \"道具\";\r\n        itemDetail.itemCount = plusHelp;\r\n        itemDetail.reason = \"使用\";\r\n        gameApplication.DataAnalytics.dealItem(2, itemDetail);\r\n    },\r\n\r\n\r\n    update(dt) {\r\n        if (this.gameOver) {\r\n            return;//stop game\r\n        }\r\n        // cc.log(\"this.enemys.length:\",this.enemys.length)\r\n        if (this.enemys.length > 0) {\r\n\r\n            //移动\r\n            for (var i = 0; i < this.enemys.length; i++) {\r\n                var enemy = this.enemys[i];\r\n                this.roundMove(enemy);\r\n            }\r\n        }\r\n\r\n        //炮塔发射子弹\r\n        if (this.allTowers.length > 0) {\r\n            for (var i = 0; i < this.allTowers.length; i++) {\r\n                var tower = this.allTowers[i];\r\n                this.towerShoot(tower);\r\n            }\r\n        }\r\n\r\n\r\n    },\r\n\r\n    //炮塔发射子弹\r\n    towerShoot(tower) {\r\n        if (!tower.isShooting) {\r\n            tower.isShooting = true;\r\n            tower.bubble.active = true;\r\n            var canMove = this.checkMove(tower.bubbleAxialCoordinate);\r\n\r\n            var direction = -1;\r\n            if ((tower.direction != -1 && canMove[tower.direction])) {\r\n                direction = tower.direction;\r\n            }\r\n\r\n            if (direction == -1) {\r\n                // cc.log(\"打到墙了，再往前移动半个格子\",canMove,tower)\r\n                // var movePlus = this.movePlus[tower.direction];\r\n                // var hcPos = cc.pCompMult(cc.v2(0.2,0.2),cc.pCompMult(cc.v2(hexTileHeight,hexTileHeight),movePlus));\r\n                // var a1 = cc.moveBy(tower['s']*0.3*0.3,hcPos.x ,hcPos.y);\r\n                //cb\r\n                var cb1 = cc.callFunc(function () {\r\n                    //播放炸开动画\r\n                    tower.bubble.getComponent(\"NormalAnimation\").play();\r\n                }, this);\r\n                var delay0 = cc.delayTime(1.0);\r\n\r\n                var cb2 = cc.callFunc(function () {\r\n                    //重置\r\n                    tower.bubbleAxialCoordinate = tower.axialCoordinate;\r\n                    tower.bubble.position = cc.pCompMult(tower.node.getPosition(), cc.v2(0.5, 0.5));\r\n                    tower.bubble.opacity = 0;\r\n                }, this);\r\n                //TODO，等待多少秒后，再次发射\r\n                var delay = cc.delayTime(tower['delay']);\r\n                var cb4 = cc.callFunc(function () {\r\n                    //重置\r\n                    tower.isShooting = false;\r\n                    tower.bubble.opacity = 255;\r\n                }, this);\r\n\r\n                var seq = cc.sequence(cb1, delay0, cb2, delay, cb4);\r\n                tower.bubble.runAction(seq);\r\n            } else {\r\n                // cc.log(\"hexTileHeight:\",hexTileHeight)\r\n                // var scale = hexTileHeight;\r\n                var scale = hexTileHeight / 100;\r\n\r\n                var nextPos = tower.bubbleAxialCoordinate.add(this.movePlus[direction]);\r\n                var hc = this.getCellByCoordinate(nextPos);\r\n\r\n                // cc.log(\"nextPos\",nextPos);\r\n                // var hcPos = tower.bubble.getPosition();\r\n                // var movePlus = this.movePlus[direction];\r\n                // hcPos = hcPos.add(cc.pCompMult(cc.v2(hexTileHeight,hexTileHeight),nextPos));\r\n                //  cc.log(\"_______movePlus:\",cc.pCompMult(cc.v2(hexTileHeight,hexTileHeight),movePlus))\r\n\r\n                // var hcPos = cc.pCompMult(cc.v2(hexTileHeight,hexTileHeight),this.movePlus[direction]);\r\n                // var hcPos = tower.bubble.convertToNodeSpaceAR(worldPosition);\r\n\r\n                let worldPosition = this.tileBox.convertToWorldSpaceAR(hc.node.getPosition());\r\n                var hcPos_tmp = tower.node.convertToNodeSpaceAR(worldPosition);\r\n\r\n                var hcPos;\r\n                // hcPos = hc.node.convertToWorldSpaceAR(hcPos)\r\n                // hcPos = tower.bubble.convertToNodeSpaceAR(hcPos);\r\n                // cc.log(\"++++++++++++worldPosition:\",worldPosition)\r\n                // cc.log(\"++++++++++++hcPos:\",hcPos)\r\n                // cc.log(\"direction:\",direction)\r\n\r\n                if (direction == 1) {\r\n                    hcPos = cc.v2(hcPos_tmp.y * -1, hcPos_tmp.x * -1);\r\n                } else if (direction == 2) {\r\n                    hcPos = cc.v2(hcPos_tmp.x * -1, hcPos_tmp.y * -1);\r\n                } else if (direction == 3) {\r\n                    hcPos = cc.v2(hcPos_tmp.y, hcPos_tmp.x);\r\n                } else {\r\n                    hcPos = cc.v2(hcPos_tmp.x, hcPos_tmp.y);\r\n                }\r\n\r\n                var a1 = cc.moveTo(tower['s'] * 0.3, hcPos.y, hcPos.x);\r\n                //cb\r\n                var cb1 = cc.callFunc(function () {\r\n                    //更新位置\r\n                    tower.bubbleAxialCoordinate = nextPos;\r\n                    tower.isShooting = false;\r\n                }, this);\r\n\r\n                var seq = cc.sequence(a1, cb1);\r\n                tower.bubble.runAction(seq);\r\n\r\n            }\r\n        }\r\n    },\r\n\r\n    //怪物自动移动\r\n    roundMove(enemy) {\r\n        if (!enemy.isMoving) {\r\n            enemy.isMoving = true;\r\n            var canMove = this.checkMove(enemy.axialCoordinate);\r\n\r\n            var direction = -1;\r\n\r\n            if ((enemy.direction != -1 && canMove[enemy.direction] && this.checkMoveDirectionCount(canMove, enemy.direction) == 1) || (enemy.direction != -1 && canMove[enemy.direction] && Math.random() > 0.6)) {\r\n                direction = enemy.direction;\r\n            } else {\r\n                while (direction == -1) {\r\n                    var idx = Utils.GetRandomNum(0, 3);\r\n                    if (canMove[idx]) {\r\n                        direction = idx;\r\n                    }\r\n                }\r\n            }\r\n\r\n            enemy.direction = direction;\r\n\r\n            var nextPos = enemy.axialCoordinate.add(this.movePlus[direction]);\r\n            var hc = this.getCellByCoordinate(nextPos);\r\n\r\n            var hcPos = hc.node.getPosition();\r\n            var a1 = cc.moveTo(1, hcPos.x, hcPos.y);\r\n            //cb\r\n            var cb1 = cc.callFunc(function () {\r\n\r\n                //更新位置\r\n                enemy.axialCoordinate = nextPos;\r\n                enemy.isMoving = false;\r\n            }, this);\r\n\r\n            var seq = cc.sequence(a1, cb1);\r\n            enemy.node.runAction(seq);\r\n        }\r\n\r\n    },\r\n\r\n    /**\r\n     * 当屏幕点击\r\n    */\r\n    onMouseDown(event) {\r\n        if (this.gameOver || this.myRole == null) {\r\n            return;\r\n        }\r\n        this.mouseIsDown = true;\r\n        this.touchPos = this.tileBox.convertToNodeSpaceAR(event.getLocation());\r\n    },\r\n\r\n    onMouseMove(event) {\r\n        if (this.gameOver || this.myRole == null) {\r\n            return;\r\n        }\r\n        if (this.mouseIsDown) {\r\n            var movePos = this.tileBox.convertToNodeSpaceAR(event.getLocation());\r\n\r\n            var offsetX = movePos.x - this.touchPos.x;\r\n            var offsetY = movePos.y - this.touchPos.y;\r\n\r\n            if (Math.abs(offsetX) < 30 && Math.abs(offsetY) < 30) {\r\n                return;\r\n            }\r\n\r\n            //根据X方向与Y方向的偏移量大小的判断  \r\n            if (Math.abs(offsetX) > Math.abs(offsetY)) {\r\n                if (offsetX < 0) {\r\n                    // cc.log(\"左\")\r\n                    this.doAction(1, true);   //左\r\n                }\r\n                else {\r\n                    // cc.log(\"右\")\r\n                    this.doAction(3, true);   //右边\r\n                }\r\n            }\r\n            else {\r\n                if (offsetY > 0) {\r\n                    this.doAction(0, true);   //上\r\n                }\r\n                else {\r\n                    this.doAction(2, true);//下\r\n                }\r\n            }\r\n\r\n            this.mouseIsDown = false;\r\n        }\r\n    },\r\n\r\n\r\n    getCellByCoordinate(_coordinate) {\r\n        for (var i = 0; i < this.allCells.length; i++) {\r\n            var hc = this.allCells[i];\r\n            if (hc.axialCoordinate.equals(_coordinate)) {\r\n                return hc;\r\n            }\r\n        }\r\n        return null;\r\n    },\r\n\r\n    stopAllAction() {\r\n        cc.log(\"stopAllAction\")\r\n    },\r\n\r\n    die() {\r\n        this.unschedule(this.timeOutflow);\r\n        this.gameOver = true;\r\n        //播放死亡动画\r\n        this.myRole.playDie();\r\n        this.gameApplication.soundManager.playSound(\"error\");\r\n\r\n        this.restarGame(2.1);\r\n    },\r\n\r\n    showGameOver() {\r\n        this.guideView.active = false;\r\n        var levelDetail = {};\r\n        levelDetail.level = mid + \"0\" + (lid > 99 ? lid : (lid > 9 ? \"0\" + lid : \"00\" + lid));\r\n        levelDetail.reason = \"过关\"\r\n        gameApplication.DataAnalytics.levelResult(true, levelDetail);\r\n\r\n        this.gameApplication.soundManager.playSound(\"gamewin\");\r\n\r\n        this.unschedule(this.timeOutflow);\r\n        this.timeIsUpInvNode.active = false;\r\n        this.timeIsUpNode.active = false;\r\n        this.watchVideoTip.active = false;\r\n\r\n        // cc.log(\"_______________showGameOver\");\r\n        var self = this;\r\n        this.gameOver = true;\r\n        this.endView.active = true;\r\n\r\n        this.stopAllAction();\r\n\r\n        var curr_star = 0;\r\n\r\n        if (this.turnBackCount <= 0) {\r\n            curr_star = 3;\r\n        } else if (this.turnBackCount <= 6) {\r\n            curr_star = 2;\r\n        } else {\r\n            curr_star = 1;\r\n        }\r\n\r\n        // cc.log(\"this.turnBackCount:\",this.turnBackCount)\r\n        // cc.log(\"this.movesLeft:\",this.movesLeft)\r\n        // cc.log(\"this.maxValidMoves:\",this.maxValidMoves)\r\n        // cc.log(\"this.moved:\",this.moved)\r\n        // cc.log(\"curr_star:\",curr_star)\r\n\r\n        /* if (lid + 1 > 100) {\r\n            this.endView_nextBtn.active = false;\r\n            this.endView_backBtn.active = true;\r\n        } else {\r\n            this.endView_nextBtn.active = true;\r\n            this.endView_backBtn.active = false;\r\n        } */\r\n\r\n        // this.setStar(this.endView_Stars.getChildByName(\"1\"),curr_star,1);\r\n        // this.setStar(this.endView_Stars.getChildByName(\"2\"),curr_star,2);\r\n        // this.setStar(this.endView_Stars.getChildByName(\"3\"),curr_star,3);\r\n\r\n        if (curr_star == 3) {\r\n            this.endView_title.string = \"GREAT\";\r\n        } else if (curr_star == 2) {\r\n            this.endView_title.string = \"GOOD\";\r\n        } else {\r\n            this.endView_title.string = \"CLEAR\";\r\n        }\r\n\r\n        this.endView_text.string = \"You finish with \" + this.moved + \" moves\";\r\n\r\n\r\n\r\n        //最好成绩\r\n        // SDK().getScore(bid+\"_\"+mid+\"_\"+lid+\"_moves\",function(best){\r\n        SDK().getScore(bid + \"_\" + mid + \"_\" + lid, function (star) {\r\n            //如果当前星星大于历史最高，那么保存\r\n            if (star < 1) {\r\n                var param = {};\r\n                param[bid + \"_\" + mid + \"_\" + lid] = 1;\r\n                SDK().setScore(param, null);\r\n\r\n                //保存个人星星\r\n                var plusStar = curr_star - star;\r\n                SDK().getScore(\"all\", function (score) {\r\n                    score += 1;\r\n                    SDK().setScore({ all: score }, null);\r\n                }.bind(this));\r\n\r\n                //保存mid关卡的星星\r\n                SDK().getScore(bid + \"_\" + mid, function (score) {\r\n                    score += 1;\r\n                    var param = {};\r\n                    param[bid + \"_\" + mid] = score;\r\n                    SDK().setScore(param, null);\r\n                }.bind(this));\r\n            }\r\n\r\n        }.bind(this));\r\n\r\n\r\n        SDK().getScore(bid + \"_\" + mid + \"_\" + lid + \"_moves\", function (best) {\r\n            if (self.moved < best || best <= 0) {\r\n                //保存历史最小步数\r\n                var param = {};\r\n                param[bid + \"_\" + mid + \"_\" + lid + \"_moves\"] = self.moved;\r\n                SDK().setScore(param, null);\r\n            }\r\n        }.bind(this));\r\n    },\r\n\r\n\r\n    checkWin() {\r\n        var isWin = this.myRole.axialCoordinate.equals(this.endObj.axialCoordinate);\r\n        if (isWin) {\r\n            // cc.log(\"到达终点，游戏结束\");\r\n            this.showGameOver();\r\n        }\r\n        return isWin;\r\n    },\r\n\r\n    moveEnd() {\r\n        this.isMoving = false;\r\n\r\n\r\n        //检查胜利\r\n        if (!this.checkWin()) {\r\n            var canMove = this.checkMove();\r\n            this.gameApplication.soundManager.playSound(\"done\");\r\n\r\n            //检查当前是否在冰上，并且前方可以走\r\n            var hc = this.getCellByCoordinate(this.myRole.axialCoordinate);\r\n            if (hc.isIce && canMove[this.lastDirection]) {\r\n                //继续行走\r\n                this.doAction(this.lastDirection, true);\r\n            } else {\r\n                //检查箭头\r\n                this.moved++;\r\n                if (this.turnBackCount > 0 && this.turnBackCount % 2 == 0 && !Utils.inArray(this.turnBackCount, this.helpShaked)) {\r\n                    this.helpBtnShake();\r\n                    this.helpShaked.push(this.turnBackCount);\r\n                }\r\n                this.myRole.setArrow(canMove[0], canMove[1], canMove[2], canMove[3]);\r\n            }\r\n        }\r\n\r\n        this.updateUI();\r\n    },\r\n\r\n    addSelectedLines(coordinate) {\r\n        var self = this;\r\n        if (this.selectedLines.length >= 2 && coordinate.equals(this.selectedLines[this.selectedLines.length - 2])) {\r\n            var tmp_coordinate = this.selectedLines.pop();\r\n            var hc = this.getCellByCoordinate(tmp_coordinate);\r\n            hc.hideLine();\r\n\r\n        } else {\r\n            this.selectedLines.push(cc.v2(coordinate.x, coordinate.y));\r\n        }\r\n\r\n        if (this.selectedLines.length > 1) {\r\n\r\n            this.scheduleOnce(function () {\r\n                //绘制路线\r\n                for (var i = 0; i <= self.selectedLines.length - 1; i++) {\r\n                    var tmp_coordinate = self.selectedLines[i];\r\n                    var hc = self.getCellByCoordinate(tmp_coordinate);\r\n                    hc.hideLine();\r\n                }\r\n                for (var i = 0; i <= self.selectedLines.length - 1; i++) {\r\n                    var tmp_coordinate = self.selectedLines[i];\r\n                    var hc = self.getCellByCoordinate(tmp_coordinate);\r\n                    if (i == 0) {\r\n                        hc.showStartLine(self.selectedLines[i + 1]);\r\n                    } else if (i == self.selectedLines.length - 1) {\r\n                        hc.showEndLine(self.selectedLines[self.selectedLines.length - 2]);\r\n                    } else {\r\n                        hc.showLine(self.selectedLines[i - 1], self.selectedLines[i + 1]);\r\n                    }\r\n                }\r\n            }, 0.08)\r\n\r\n\r\n        }\r\n\r\n    },\r\n\r\n    //移动\r\n    doAction(direction, manual) {\r\n        this.isMemu = false;\r\n        if (this.isMoving || this.gameOver) {\r\n            return;\r\n        }\r\n\r\n        this.isMoving = true;\r\n        this.myRole.hideArrow();\r\n        var self = this;\r\n        var canMove = this.checkMove();\r\n\r\n        if (!manual && this.checkMoveDirectionCount(canMove, direction) > 1) {\r\n            //遇到路口停止\r\n            // cc.log(\"遇到路口停止\",this.checkMoveDirectionCount(canMove,direction))\r\n            this.moveEnd();\r\n            return;\r\n        }\r\n\r\n        if (canMove[direction]) {\r\n            var nextPos = this.myRole.axialCoordinate.add(this.movePlus[direction]);\r\n            var hc = this.getCellByCoordinate(nextPos);\r\n\r\n            // cc.log(\"可以移动到\",nextPos)\r\n            if (hc != null) {\r\n\r\n                //检查是否走回头路\r\n                var isTurnBack = false;\r\n                if (direction == 0) {\r\n\r\n                    isTurnBack = this.lastDirection == 2;\r\n                } else if (direction == 3) {\r\n                    isTurnBack = this.lastDirection == 1;\r\n                } else if (direction == 1) {\r\n\r\n                    isTurnBack = this.lastDirection == 3;\r\n                } else {\r\n                    isTurnBack = this.lastDirection == 0;\r\n                }\r\n                if (isTurnBack) {\r\n                    this.turnBackCount++;\r\n                }\r\n\r\n\r\n                this.lastDirection = direction;\r\n\r\n                var hcPos = hc.node.getPosition();\r\n                var a1 = cc.moveTo(0.12, hcPos.x, hcPos.y);\r\n                //cb\r\n                var cb1 = cc.callFunc(function () {\r\n\r\n                    //更新位置\r\n                    self.myRole.axialCoordinate = nextPos;\r\n                    self.isMoving = false;\r\n                    if (!self.checkWin()) {\r\n                        self.doAction(direction, false);\r\n                    }\r\n                }, this);\r\n\r\n                //路线\r\n                this.addSelectedLines(nextPos);\r\n\r\n                var seq = cc.sequence(a1, cb1);\r\n                self.myRole.node.runAction(seq);\r\n            }\r\n\r\n        } else {\r\n            this.gameApplication.soundManager.playSound(\"done\");\r\n\r\n            if (this.checkMoveDirectionCount(canMove, direction) == 1) {\r\n                direction = this.getkMoveDirection(canMove, direction);\r\n                // cc.log(\"遇到路口，但只有一个路径。改变路径：\",direction)   \r\n                if (!this.checkWin()) {\r\n                    var hc = this.getCellByCoordinate(this.myRole.axialCoordinate);\r\n                    if (!hc.isIce) {\r\n                        this.isMoving = false;\r\n                        self.doAction(direction, true);\r\n                    } else {\r\n                        this.moveEnd();\r\n                    }\r\n                }\r\n            } else {\r\n                // cc.log(\"不能移动\",direction)    \r\n                this.moveEnd();\r\n            }\r\n        }\r\n    },\r\n\r\n    //获取唯一可以移动的路径\r\n    getkMoveDirection(canMove, direction) {\r\n        var c;\r\n        //t,l,d,r\r\n        if (direction == 0) {\r\n            c = 2;\r\n        } else if (direction == 3) {\r\n            c = 1;\r\n        } else if (direction == 1) {\r\n            c = 3;\r\n        } else {\r\n            c = 0;\r\n        }\r\n        var count = 0;\r\n        for (var i = 0; i < canMove.length; i++) {\r\n            var v = canMove[i];\r\n            if (v && i != c)\r\n                return i;\r\n        };\r\n    },\r\n\r\n    checkCanMoveCount(canMove) {\r\n        var c;\r\n        var count = 0;\r\n        for (var i = 0; i < canMove.length; i++) {\r\n            var v = canMove[i];\r\n            if (v)\r\n                count++;\r\n        };\r\n        return count;\r\n    },\r\n\r\n\r\n    //获取可以移动的方向，不算direction的反方向\r\n    checkMoveDirectionCount(canMove, direction) {\r\n        var c;\r\n        //t,l,d,r\r\n        if (direction == 0) {\r\n            c = 2;\r\n        } else if (direction == 3) {\r\n            c = 1;\r\n        } else if (direction == 1) {\r\n            c = 3;\r\n        } else {\r\n            c = 0;\r\n        }\r\n        var count = 0;\r\n        for (var i = 0; i < canMove.length; i++) {\r\n            var v = canMove[i];\r\n            if (v && i != c)\r\n                count++;\r\n        };\r\n        return count;\r\n    },\r\n\r\n    //检查可以移动的方向\r\n    checkMove(axialCoordinate) {\r\n        if (axialCoordinate == null) {\r\n            axialCoordinate = this.myRole.axialCoordinate;\r\n        }\r\n\r\n        var neighbors = Utils.getNeighborsOBJ(axialCoordinate);\r\n        var t = true, l = true, d = true, r = true;\r\n\r\n        var hc = this.getCellByCoordinate(axialCoordinate);\r\n        if (hc != null) {\r\n            if (hc.leftActive) {\r\n                l = false;\r\n            }\r\n            if (hc.rightActive) {\r\n                r = false;\r\n            }\r\n            if (hc.topActive) {\r\n                t = false;\r\n            }\r\n            if (hc.bottomActive) {\r\n                d = false;\r\n            }\r\n        }\r\n\r\n        if (t) {\r\n            var tc = this.getCellByCoordinate(neighbors.t);\r\n            if (tc != null && tc.bottomActive) {\r\n                t = false;\r\n            }\r\n        }\r\n\r\n        if (d) {\r\n            var dc = this.getCellByCoordinate(neighbors.b);\r\n            if (dc != null && dc.topActive) {\r\n                d = false;\r\n            }\r\n        }\r\n\r\n        if (l) {\r\n            var lc = this.getCellByCoordinate(neighbors.l);\r\n            if (lc != null && lc.rightActive) {\r\n                l = false;\r\n            }\r\n        }\r\n\r\n        if (r) {\r\n            var rc = this.getCellByCoordinate(neighbors.r);\r\n            if (rc != null && rc.leftActive) {\r\n                r = false;\r\n            }\r\n        }\r\n\r\n        return [t, l, d, r]\r\n\r\n\r\n    },\r\n\r\n    checkMovePos(axialCoordinate) {\r\n        if (axialCoordinate == null) {\r\n            axialCoordinate = this.myRole.axialCoordinate;\r\n        }\r\n\r\n        var neighbors = Utils.getNeighborsOBJ(axialCoordinate);\r\n        var t = neighbors.t, l = neighbors.l, d = neighbors.b, r = neighbors.r;\r\n\r\n        var hc = this.getCellByCoordinate(axialCoordinate);\r\n        if (hc != null) {\r\n            if (hc.leftActive) {\r\n                l = cc.v2(-1, -1);\r\n            }\r\n            if (hc.rightActive) {\r\n                r = cc.v2(-1, -1);\r\n            }\r\n            if (hc.topActive) {\r\n                t = cc.v2(-1, -1);\r\n            }\r\n            if (hc.bottomActive) {\r\n                d = cc.v2(-1, -1);\r\n            }\r\n        }\r\n\r\n        if (t) {\r\n            var tc = this.getCellByCoordinate(neighbors.t);\r\n            if (tc != null && tc.bottomActive) {\r\n                t = cc.v2(-1, -1);\r\n            }\r\n        }\r\n\r\n        if (d) {\r\n            var dc = this.getCellByCoordinate(neighbors.b);\r\n            if (dc != null && dc.topActive) {\r\n                d = cc.v2(-1, -1);\r\n            }\r\n        }\r\n\r\n        if (l) {\r\n            var lc = this.getCellByCoordinate(neighbors.l);\r\n            if (lc != null && lc.rightActive) {\r\n                l = cc.v2(-1, -1);\r\n            }\r\n        }\r\n\r\n        if (r) {\r\n            var rc = this.getCellByCoordinate(neighbors.r);\r\n            if (rc != null && rc.leftActive) {\r\n                r = cc.v2(-1, -1);\r\n            }\r\n        }\r\n\r\n        return [t, l, d, r]\r\n\r\n\r\n    },\r\n\r\n    createEnemy(enemys) {\r\n        var scale = hexTileHeight / 100;\r\n\r\n        if (enemys.length <= 0) {\r\n            return;\r\n        }\r\n\r\n        for (var i = 0; i < enemys.length; i++) {\r\n            var enemy = enemys[i];\r\n            var hc = this.getCellByCoordinate(cc.v2(enemy.x, enemy.y));\r\n\r\n            var enemy_GO;\r\n            var random = Math.random();\r\n            if (random < 0.33) {\r\n                enemy_GO = cc.instantiate(this.enemyPrefab);\r\n            } else if (random < 0.66) {\r\n                enemy_GO = cc.instantiate(this.enemyPrefab1);\r\n            } else {\r\n                enemy_GO = cc.instantiate(this.enemyPrefab2);\r\n            }\r\n            enemy_GO.parent = this.tileBox;\r\n            enemy_GO.setScale(scale);\r\n            enemy_GO.setPosition(hc.node.getPosition());\r\n            enemy_GO.active = true;\r\n\r\n            //auto color colors\r\n            // enemy_GO.getChildByName(\"enemy\").color = cc.hexToColor(colors[Utils.GetRandomNum(0,colors.length-1)]);\r\n\r\n            var enemy = enemy_GO.getComponent(Enemy);\r\n            enemy.axialCoordinate = hc.axialCoordinate;\r\n            this.enemys.push(enemy);\r\n        }\r\n    },\r\n\r\n    createRole(start, end) {\r\n        var scale = hexTileHeight / 100;\r\n\r\n        start = this.checkXY(start, 0, 0);\r\n        end = this.checkXY(end, 0, 0);\r\n\r\n        var hc = this.getCellByCoordinate(cc.v2(start.x, start.y));\r\n        var hc1 = this.getCellByCoordinate(cc.v2(end.x, end.y));\r\n\r\n        var role_GO = cc.instantiate(this.rolePrefab);\r\n        role_GO.parent = this.tileBox;\r\n        role_GO.setScale(scale);\r\n        role_GO.setPosition(hc.node.getPosition());\r\n        role_GO.active = true;\r\n\r\n        var role = role_GO.getComponent(Role);\r\n        this.myRole = role;\r\n        this.myRole.init();\r\n        this.myRole.axialCoordinate = hc.axialCoordinate;\r\n        this.selectedLines.push(cc.v2(hc.axialCoordinate.x, hc.axialCoordinate.y));\r\n        var canMove = this.checkMove();\r\n        this.myRole.setArrow(canMove[0], canMove[1], canMove[2], canMove[3]);\r\n\r\n        var end_GO = cc.instantiate(this.endPrefab);\r\n        end_GO.parent = this.tileBox;\r\n        end_GO.setScale(scale);\r\n        end_GO.setPosition(hc1.node.getPosition());\r\n        end_GO.active = true;\r\n        this.endNode = end_GO;\r\n\r\n        var endObj = end_GO.getComponent(Role);\r\n        this.endObj = endObj;\r\n        this.endObj.axialCoordinate = hc1.axialCoordinate;\r\n\r\n        this.myRole.gameView = this;\r\n        this.myRole.setDark(mid == 4);\r\n\r\n    },\r\n\r\n    //发送碰撞即死亡\r\n    collisionCallback() {\r\n        // cc.log(this)\r\n        this.die();\r\n    },\r\n\r\n    //初始化格子\r\n    createGrid(_levelDimensions, walls, ices, towers, cb) {\r\n        this.gridOffset.x = 0;\r\n        this.gridOffset.y = 0;\r\n        var maxL = Math.max(_levelDimensions.x, _levelDimensions.y);\r\n        // cc.log (\"maxL:\" + maxL);\r\n        var winSize = cc.director.getWinSize();\r\n        var tileBoxSize = this.tileBox.getContentSize();\r\n        var tileBoxHeight = tileBoxSize.height;\r\n        var hexH = winSize.width;\r\n        hexTileHeight = (hexH - (lineWidth - lineWidth * _levelDimensions.x)) / _levelDimensions.x;\r\n        // cc.log(\"hexTileHeight:\",hexTileHeight);\r\n\r\n        var nowHeight = (hexTileHeight * _levelDimensions.y);\r\n\r\n        // cc.log(\"hexTileHeight:\",hexTileHeight);\r\n        // cc.log(\"tileBoxHeight:\",tileBoxHeight);\r\n        // cc.log(\"nowHeight:\",nowHeight);\r\n        // 1065    1335.1789638932496\r\n        if (tileBoxHeight < nowHeight) {\r\n            hexH = tileBoxSize.height;\r\n            var testHexTileHeight = (hexH - (lineWidth - lineWidth * _levelDimensions.y)) / _levelDimensions.y;\r\n            // cc.log(\"testHexTileHeight:\",testHexTileHeight);\r\n            if (testHexTileHeight < hexTileHeight) {\r\n                hexTileHeight = testHexTileHeight;\r\n                this.gridOffset.x = (winSize.width - (_levelDimensions.x * hexTileHeight) + _levelDimensions.x * lineWidth) * 0.5;\r\n            }\r\n            // cc.log(\"hexTileHeight:\",hexTileHeight);\r\n            // cc.log(\"winSize.width:\",winSize.width);\r\n            // cc.log(\"this.levelDimensions.x:\",this.levelDimensions.x);\r\n            // cc.log(\"this.levelDimensions.x * hexTileHeight:\",this.levelDimensions.x * hexTileHeight);\r\n\r\n        }\r\n\r\n        // cc.log(\"tileBox:\",this.tileBox.getContentSize());\r\n\r\n        sideLength = hexTileHeight;\r\n        // cc.log (\"sideLength:\" + sideLength);\r\n\r\n        var sizeW = sideLength;\r\n        var sizeH = sideLength;\r\n\r\n        this.levelDimensions = _levelDimensions;\r\n\r\n        var hexTile;\r\n        var hc;\r\n        var axialPoint = cc.v2(0, 0);\r\n        var screenPoint = cc.v2(0, 0);\r\n\r\n        var test = (tileBoxSize.height - (this.levelDimensions.y * hexTileHeight) + this.levelDimensions.y * lineWidth) * 0.5\r\n        this.gridOffset.y = (tileBoxSize.height * -1) + test;\r\n\r\n        //loop through the rows & columns \r\n\r\n        for (var i = 0; i < this.levelDimensions.x; i++) {\r\n            for (var j = 0; j < this.levelDimensions.y; j++) {\r\n                axialPoint.x = i;\r\n                axialPoint.y = j;\r\n                // cc.log(\"axialPoint:\",axialPoint);\r\n                //convert offset points to axial points\r\n                // axialPoint = Utils.offsetToAxial(axialPoint);\r\n                // cc.log(\"axialPoint:\",axialPoint);\r\n\r\n                //convert axial points to screen points\r\n                screenPoint = Utils.axialToScreen(axialPoint, sideLength);\r\n                // cc.log (\"screenPoint:\" ,screenPoint);\r\n                //add the grid offset value to position the grid\r\n                screenPoint.x += this.gridOffset.x;\r\n                screenPoint.y += this.gridOffset.y;\r\n\r\n                // cc.log (\"screenPoint:\" + screenPoint.x+\"___\"+screenPoint.y);\r\n                //place new hextile\r\n                hexTile = cc.instantiate(this.hexCellPrefab);\r\n                hexTile.parent = this.tileBox;\r\n\r\n                hexTile.setPosition(screenPoint.add(cc.v2(0, 1000)));\r\n                hexTile.setContentSize(cc.size(sizeW, sizeW));\r\n                hexTile.active = true;\r\n\r\n                var self = this;\r\n                if (j % 2 == 0) {\r\n                    hexTile.runAction(cc.sequence(\r\n                        cc.moveTo(0.2 + (0.05 * axialPoint.y), screenPoint.x, screenPoint.y),\r\n                        cc.callFunc(function () {\r\n                            self.gameApplication.soundManager.playSound(\"uplock\");\r\n                        })\r\n                    ));\r\n                    // hexTile.runAction(cc.moveTo(0.2+(0.05*axialPoint.y), screenPoint.x,screenPoint.y));\r\n                } else {\r\n                    hexTile.runAction(cc.moveTo(0.2 + (0.05 * axialPoint.y), screenPoint.x, screenPoint.y));\r\n                }\r\n\r\n\r\n\r\n                //we will identify hextile by name\r\n                hexTile.name = \"grid\" + i.toString() + \"_\" + j.toString();\r\n                hexTile.zIndex = 0;\r\n\r\n                hc = hexTile.getComponent(HexCell);\r\n                hc.scaleChild(sizeW / 100, sizeW / 100);\r\n\r\n                // //store the converted axial coordinate inside the hexcell for easier reference\r\n                hc.axialCoordinate = axialPoint;\r\n                // //add to the list\r\n                this.allCells.push(hc);\r\n            }\r\n        }\r\n\r\n        if (walls == null || walls.length <= 0) {\r\n            return;\r\n        }\r\n\r\n        var self = this;\r\n        var wx = 0, wy = 0, dx = 0, dy = 0;\r\n        for (var i = 0; i < walls.length; i++) {\r\n            // for(var i =0;i<20;i++){\r\n            var wall = walls[i];\r\n            var tmp_w1 = self.checkXY(wall['w1'], wx, wy);\r\n            var tmp_d1 = self.checkXY(wall['d1'], dx, dy);\r\n            var w1;\r\n            var d1;\r\n\r\n            // dx = d1.x;\r\n            // dy = d1.y; \r\n            // cc.log(\"w1:\",w1);\r\n            // cc.log(\"w1-x:\"+tmp_w1.x+\",w1-y:\"+tmp_w1.y+\"_____d1-x:\"+tmp_d1.x+\",d1-y:\"+tmp_d1.y);\r\n            //设置\r\n            var hc;\r\n            if (tmp_w1.x < tmp_d1.x || tmp_w1.y > tmp_d1.y) {\r\n                w1 = tmp_w1;\r\n                d1 = tmp_d1;\r\n            } else {\r\n                w1 = tmp_d1;\r\n                d1 = tmp_w1;\r\n            }\r\n\r\n            if (hc = this.getCellByCoordinate(cc.v2(w1.x, w1.y - 1))) {\r\n                if (w1.x == d1.x) {\r\n                    //画竖线\r\n                    // cc.log(\"setLeft\")\r\n                    hc.setLeft(true);\r\n                } else {\r\n                    // cc.log(\"setTop\")\r\n                    hc.setTop(true);\r\n\r\n                }\r\n            } else if (hc = this.getCellByCoordinate(cc.v2(w1.x, w1.y))) {\r\n                if (w1.x == d1.x) {\r\n                    // cc.log(\"setRight\")       \r\n                    hc.setRight(true);\r\n                } else {\r\n                    // cc.log(\"setBottom\")       \r\n                    hc.setBottom(true);\r\n\r\n                }\r\n            } else if (hc = this.getCellByCoordinate(cc.v2(w1.x - 1, w1.y - 1))) {\r\n                // cc.log(\"hchchchchc\",hc)\r\n                if (w1.x == d1.x) {\r\n                    // cc.log(\"seRight\")       \r\n                    hc.setRight(true);\r\n                } else {\r\n                    // cc.log(\"setBottom\")       \r\n                    hc.setBottom(true);\r\n\r\n                }\r\n            }\r\n        };\r\n\r\n        //播放动画\r\n        this.scheduleOnce(function () {\r\n\r\n\r\n            if (ices != null && ices.length > 0) {\r\n                for (var i = 0; i < ices.length; i++) {\r\n                    var ice = ices[i];\r\n                    var hc = this.getCellByCoordinate(cc.v2(ice.x, ice.y));\r\n\r\n                    if (hc != null) {\r\n                        hc.setIce(true);\r\n                        var iceNode = cc.instantiate(this.icePrefab);\r\n                        iceNode.parent = this.iceBox;\r\n\r\n                        iceNode.setPosition(hc.node.getPosition());\r\n                        iceNode.setContentSize(hc.node.getContentSize());\r\n                        iceNode.active = true;\r\n\r\n                        iceNode.setScale(0.3, 0.3);\r\n                        iceNode.runAction(cc.scaleTo(0.35, 1, 1))\r\n                    }\r\n                }\r\n            }\r\n\r\n\r\n            // cc.log(\"towers:\",towers)\r\n            if (towers != null && towers.length > 0) {\r\n                for (var i = 0; i < towers.length; i++) {\r\n                    var tower = towers[i];\r\n                    // cc.log(\"tower:\",tower)\r\n\r\n\r\n                    var tmp_w1 = self.checkXY(tower['w1'], wx, wy);\r\n                    var tmp_d1 = self.checkXY(tower['d1'], dx, dy);\r\n                    var w1;\r\n                    var d1;\r\n\r\n                    // dx = d1.x;\r\n                    // dy = d1.y; \r\n                    // cc.log(\"w1:\",w1);\r\n                    //设置\r\n                    var hc = null;\r\n                    if (tmp_w1.x < tmp_d1.x || tmp_w1.y > tmp_d1.y) {\r\n                        w1 = tmp_w1;\r\n                        d1 = tmp_d1;\r\n                    } else {\r\n                        w1 = tmp_d1;\r\n                        d1 = tmp_w1;\r\n                    }\r\n\r\n                    // cc.log(\"w1-x:\"+tmp_w1.x+\",w1-y:\"+tmp_w1.y+\"_____d1-x:\"+tmp_d1.x+\",d1-y:\"+tmp_d1.y);\r\n\r\n                    if (tower['direction'] == 1) {\r\n                        hc = this.getCellByCoordinate(cc.v2(Math.max(w1.x, d1.x) - 1, d1.y));\r\n                        if (hc == null) {\r\n                            hc = this.getCellByCoordinate(cc.v2(Math.max(w1.x, d1.x), d1.y));\r\n                        }\r\n                    }\r\n                    else if (tower['direction'] == 3) {\r\n                        hc = this.getCellByCoordinate(cc.v2(Math.max(w1.x, d1.x), d1.y));\r\n                        if (hc == null) {\r\n                            hc = this.getCellByCoordinate(cc.v2(Math.max(w1.x, d1.x) - 1, d1.y));\r\n                        }\r\n                    }\r\n                    else if (tower['direction'] == 0) {\r\n                        hc = this.getCellByCoordinate(cc.v2(w1.x, Math.min(w1.y, d1.y)));\r\n                        if (hc == null) {\r\n                            hc = this.getCellByCoordinate(cc.v2(w1.x, Math.max(w1.y, d1.y)));\r\n                        }\r\n                    }\r\n                    else if (tower['direction'] == 2) {\r\n                        hc = this.getCellByCoordinate(cc.v2(w1.x, Math.max(w1.y, d1.y) - 1));\r\n                        if (hc == null) {\r\n                            hc = this.getCellByCoordinate(cc.v2(w1.x, Math.max(w1.y, d1.y)));\r\n                        }\r\n                    }\r\n\r\n                    if (hc != null) {\r\n                        if (w1.x == d1.x) {\r\n                            //画竖线\r\n                            if (tower['direction'] == 1) {\r\n                                hc.setRightTower(true);\r\n                                this.pushTower(hc.rightTower, hc.axialCoordinate, tower);\r\n                            } else {\r\n                                hc.setLeftTower(true);\r\n                                this.pushTower(hc.leftTower, hc.axialCoordinate, tower);\r\n                            }\r\n                        } else {\r\n                            if (tower['direction'] == 0) {\r\n                                hc.setTopTower(true);\r\n                                this.pushTower(hc.topTower, hc.axialCoordinate, tower);\r\n                            } else {\r\n                                hc.setBottomTower(true);\r\n                                this.pushTower(hc.bottomTower, hc.axialCoordinate, tower);\r\n                            }\r\n                        }\r\n\r\n                        hc.node.zIndex = 1;\r\n                    }\r\n                }\r\n            }\r\n\r\n            if (cb) {\r\n                cb();\r\n            }\r\n        }.bind(this), 0.5 + (0.05 * this.levelDimensions.y));\r\n    },\r\n\r\n    //将tower push到this.allTowers\r\n    pushTower(node, axialCoordinate, config) {\r\n        var tower = node.getComponent(Tower);\r\n        tower.axialCoordinate = axialCoordinate;\r\n        tower.init(config);\r\n        this.allTowers.push(tower)\r\n    },\r\n\r\n\r\n    checkXY(dict, x, y) {\r\n        // if(dict['x'] == null && dict['y'] == null){\r\n        //     return null;\r\n        // }\r\n        // cc.log(\"dict:\",dict);\r\n        if (dict['x'] == null) {\r\n            dict['x'] = y;\r\n        }\r\n        if (dict['y'] == null) {\r\n            dict['y'] = x;\r\n        }\r\n\r\n        return dict;\r\n    },\r\n\r\n    updateUI() {\r\n\r\n        // JsonObject act = new JsonObject() { \r\n        //     { \"type\", \"updateUI\" },\r\n        // };\r\n        // DoLuaAction (act.ToString());\r\n\r\n        //\r\n        if (this.moved > this.maxValidMoves) {\r\n            this.moves.string = \"<color=#ff0000>\" + this.moved + \"</c>/\" + this.maxValidMoves;\r\n        } else {\r\n            this.moves.string = this.moved + \"/\" + this.maxValidMoves;\r\n        }\r\n    },\r\n\r\n    setStar(node, score, f) {\r\n        // var isFill = score >= f;\r\n        // node.getChildByName(\"empty\").active = !isFill;\r\n        // node.getChildByName(\"fill\").active = isFill;\r\n    },\r\n\r\n    onBackBtnClicked(event) {\r\n        if (this.gameApplication != null) {\r\n            this.gameApplication.soundManager.playSound(\"btn_click\");\r\n        }\r\n        if (event != null) {\r\n            var btn = event.target.getComponent(cc.Button);\r\n            btn.interactable = false;\r\n        }\r\n        \r\n        var levelDetail = {};\r\n        levelDetail.level = mid + \"0\" + (lid > 99 ? lid : (lid > 9 ? \"0\" + lid : \"00\" + lid));\r\n        levelDetail.reason = \"失败\"\r\n        gameApplication.DataAnalytics.levelResult(false, levelDetail);\r\n\r\n        gameApplication.PopGameView.active = false;\r\n        cc.director.loadScene(\"main\");\r\n    },\r\n\r\n    onNextBtnClicked(event, type) {\r\n        var btn = event.target.getComponent(cc.Button);\r\n        btn.interactable = false;\r\n        this.scheduleOnce(function () {\r\n            btn.interactable = true;\r\n        }, 1);\r\n\r\n        if (type != \"pass\") {\r\n            var levelDetail = {};\r\n            levelDetail.level = mid + \"0\" + (lid > 99 ? lid : (lid > 9 ? \"0\" + lid : \"00\" + lid));\r\n            levelDetail.reason = \"进入下一关\"\r\n            gameApplication.DataAnalytics.levelResult(false, levelDetail);\r\n        }\r\n        // cc.log(\"onNextBtnClicked\")\r\n        this.gameApplication.soundManager.playSound(\"btn_click\");\r\n        this.nextGame(btn);\r\n    },\r\n\r\n    onPreviousBtnClicked(event) {\r\n        // cc.log(\"onPreviousBtnClicked\")\r\n        var btn = event.target.getComponent(cc.Button);\r\n        btn.interactable = false;\r\n        this.scheduleOnce(function () {\r\n            btn.interactable = true;\r\n        }, 1);\r\n\r\n        var levelDetail = {};\r\n        levelDetail.level = mid + \"0\" + (lid > 99 ? lid : (lid > 9 ? \"0\" + lid : \"00\" + lid));\r\n        levelDetail.reason = \"点击上一关按钮\"\r\n        gameApplication.DataAnalytics.levelResult(false, levelDetail);\r\n\r\n        this.gameApplication.soundManager.playSound(\"btn_click\");\r\n        this.prevGame();\r\n    },\r\n\r\n    onReStarBtnClicked(event, type) {\r\n        var btn = event.target.getComponent(cc.Button);\r\n        btn.interactable = false;\r\n        this.scheduleOnce(function () {\r\n            btn.interactable = true;\r\n        }, 1);\r\n\r\n        var levelDetail = {};\r\n        levelDetail.level = mid + \"0\" + (lid > 99 ? lid : (lid > 9 ? \"0\" + lid : \"00\" + lid));\r\n        levelDetail.reason = \"点击重玩按钮\"\r\n        if (type == \"1\") {\r\n            levelDetail.reason = \"时间不够\";\r\n        }\r\n        gameApplication.DataAnalytics.levelResult(false, levelDetail);\r\n\r\n        this.gameApplication.soundManager.playSound(\"btn_click\");\r\n\r\n        this.restarGame();\r\n    },\r\n\r\n    onHelpBtnClicked(event) {\r\n\r\n        if (this.gameOver || this.myRole == null) {\r\n            return;\r\n        }\r\n        if (this.helpPath.length <= 0) {\r\n            return;\r\n        }\r\n        if (this.helpCount > 0) {\r\n\r\n            this.gameApplication.soundManager.playSound(\"btn_click\");\r\n            this.help();\r\n        } else {\r\n            this.gameApplication.soundManager.playSound(\"btn_click\");\r\n\r\n            // cc.log(\"提示看广告获得\",Math.random())\r\n            /* if (SDK().hasVideoAd() && Math.random() > 0.4) {\r\n                this.watchVideoTip.active = true;\r\n            } else {\r\n                this.shareFriendTip.active = true;\r\n            } */\r\n            this.watchVideoTip.active = true;\r\n        }\r\n    },\r\n\r\n\r\n\r\n    onWatchVideoBtnClicked(event) {\r\n        this.gameApplication.soundManager.playSound(\"btn_click\");\r\n\r\n        // cc.log(\"onWatchVideoBtnClicked\");\r\n        event.target.getComponent(cc.Button).interactable = false;\r\n\r\n        var self = this;\r\n        SDK().showVideoAd(function (isCompleted) {\r\n            if (isCompleted) {\r\n                self.helpCount = plusHelp;\r\n                gameApplication.DataAnalytics.doEvent(\"播放视频广告成功\");\r\n                var itemDetail = {};\r\n                itemDetail.itemID = \"提示\";\r\n                itemDetail.itemType = \"道具\";\r\n                itemDetail.itemCount = plusHelp;\r\n                itemDetail.reason = \"看视频获得\";\r\n                gameApplication.DataAnalytics.dealItem(1, itemDetail);\r\n            } else {\r\n                cc.log(\"播放视频广告失败\")\r\n                gameApplication.DataAnalytics.doEvent(\"播放视频广告失败\");\r\n            }\r\n\r\n            event.target.getComponent(cc.Button).interactable = true;\r\n            self.watchVideoTip.active = false;\r\n            self.shareFriendTip.active = false;\r\n\r\n        }.bind(this));\r\n    },\r\n\r\n    onShareInvBtnClicked(event) {\r\n        // cc.log(\"onWatchVideoBtnClicked\");\r\n        // event.target.getComponent(cc.Button).interactable = false;\r\n        this.gameApplication.soundManager.playSound(\"btn_click\");\r\n\r\n        var self = this;\r\n        this.gameApplication.soundManager.playSound(\"done\");\r\n        SDK().getScore(\"all\", function (score) {\r\n            SDK().share(score, function (isCompleted) {\r\n                if (isCompleted) {\r\n                    self.helpCount = plusHelp;\r\n                    console.log(\"邀请成功\")\r\n                    var itemDetail = {};\r\n                    itemDetail.itemID = \"提示\";\r\n                    itemDetail.itemType = \"道具\";\r\n                    itemDetail.itemCount = plusHelp;\r\n                    itemDetail.reason = \"分享获得\";\r\n                    gameApplication.DataAnalytics.dealItem(1, itemDetail);\r\n                } else {\r\n                    console.log(\"邀请失败\")\r\n                    gameApplication.DataAnalytics.doEvent(\"分享失败\");\r\n                    self.showInvAgain(1, event);\r\n                }\r\n                event.target.getComponent(cc.Button).interactable = true;\r\n                self.watchVideoTip.active = false;\r\n                self.shareFriendTip.active = false;\r\n            });\r\n\r\n        }.bind(this));\r\n    },\r\n\r\n    showInvAgain(type, event) {\r\n        var self = this;\r\n        this.invAgain.active = true;\r\n        var btn = cc.find(\"box/btn_4\", this.invAgain).getComponent(cc.Button);\r\n        btn.node.on('click', function () {\r\n            if (type == 1) {\r\n                self.onShareInvBtnClicked(event);\r\n            } else if (type == 2) {\r\n                self.onShareBtnClicked(event);\r\n            } else if (type == 3) {\r\n                self.getMoreTimeInv(event);\r\n            }\r\n            self.invAgain.active = false;\r\n        }, this);\r\n    },\r\n\r\n    onCloseWatchVideoTipClicked() {\r\n        this.gameApplication.soundManager.playSound(\"btn_click\");\r\n        this.watchVideoTip.active = false;\r\n        this.shareFriendTip.active = false;\r\n    },\r\n\r\n\r\n    onShareBtnClicked(event, closeSelf) {\r\n        var self = this;\r\n        this.gameApplication.soundManager.playSound(\"btn_click\");\r\n        event.target.getComponent(cc.Button).interactable = false;\r\n        event.target.active = true;\r\n\r\n        this.gameApplication.soundManager.playSound(\"done\");\r\n        SDK().getScore(\"all\", function (score) {\r\n            SDK().share(score, function (isCompleted) {\r\n                event.target.getComponent(cc.Button).interactable = true;\r\n                event.target.active = true;\r\n                if (!isCompleted) {\r\n                    gameApplication.DataAnalytics.doEvent(\"分享失败\");\r\n                    self.showInvAgain(2, event);\r\n                } else {\r\n                    gameApplication.DataAnalytics.doEvent(\"分享成功\");\r\n                }\r\n            });\r\n        }.bind(this));\r\n    },\r\n\r\n    goShare(){\r\n        this.goShareView.active = false;\r\n        SDK().getScore(\"all\", function (score) {\r\n            SDK().share(score, null);\r\n        }.bind(this));\r\n    },\r\n\r\n    helpBtnShake() {\r\n        this.helpBtn.getComponent(\"AnimFunc\").shake();\r\n    },\r\n\r\n});\r\n"]}