{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\Script\\UI/assets\\Script\\UI\\MainView.js"],"names":["cc","Class","extends","Component","properties","noAdsView","default","type","Node","title","Label","starts","content","missionItem","missionSpriteAtlas","SpriteAtlas","missions","gameApplication","Object","watchADTip","unlock_bid","Integer","unlock_mid","unlock_ad","watched_ad","missionNodes","musicBtn","Sprite","musicOff","SpriteFrame","musicOn","onLoad","find","getComponent","init","director","preloadScene","start","showNoAds","active","hideNoAds","onEnable","checkMusic","event","isDis","soundManager","isOpen","setIsOpen","spriteFrame","keys","length","getMissions","results","initContents","bind","self","SDK","getScore","score","string","toString","hideAllItem","idx","forEach","mission","initMissionItem","cannonNode","instantiate","parent","tag","bgPath","starObj","getChildByName","lockObj","getSpriteFrame","stars","bid","mid","isUnlock","test","path","getConf","onWatchVideoBtnClicked","showVideoAd","isCompleted","showLevelPanel","param","setScore","log","onMissionItemClicked","target","targetBtn","Button","interactable","parseInt","childrenCount","children","n","destroy","openLevelView","playSound","onBackBtnClicked","backToWelcome"],"mappings":"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","file":"MainView.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\Script\\UI","sourcesContent":["cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        noAdsView:{\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        title: {\r\n            default: null,\r\n            type: cc.Label,\r\n        },\r\n        starts: {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        content: {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        missionItem: {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        missionSpriteAtlas: {\r\n            default: null,\r\n            type: cc.SpriteAtlas,\r\n        },\r\n        missions:{\r\n            default:null,\r\n        },\r\n        gameApplication:{\r\n            default:null,\r\n            type:Object\r\n        },\r\n        watchADTip:{\r\n            default:null,\r\n            type:cc.Node,\r\n        },\r\n        unlock_bid:{\r\n            default:0,\r\n            type:cc.Integer,\r\n        }, \r\n        unlock_mid:{\r\n            default:0,\r\n            type:cc.Integer,\r\n        },\r\n        unlock_ad:{\r\n            default:0,\r\n            type:cc.Integer,\r\n        },\r\n        watched_ad:{\r\n            default:0,\r\n            type:cc.Integer,\r\n        },\r\n        missionNodes:{\r\n            default:{}\r\n        },\r\n        musicBtn:{\r\n            default:null,\r\n            type:cc.Sprite,\r\n        },\r\n        musicOff:{\r\n            default:null,\r\n            type:cc.SpriteFrame,\r\n        },\r\n        musicOn:{\r\n            default:null,\r\n            type:cc.SpriteFrame,\r\n        },\r\n    }, \r\n\r\n    onLoad: function () {\r\n\r\n        this.gameApplication = cc.find(\"GameApplication\").getComponent(\"GameApplication\");\r\n        this.init();\r\n        cc.director.preloadScene(\"game\", function () {\r\n        });\r\n    },\r\n\r\n    start () {\r\n\r\n    },\r\n\r\n    showNoAds(){\r\n        this.noAdsView.active = true;\r\n    },\r\n\r\n    hideNoAds(){\r\n        this.noAdsView.active = false;\r\n    },\r\n\r\n    onEnable(){\r\n        this.checkMusic();\r\n    },\r\n\r\n\r\n    checkMusic(event,isDis){\r\n        if(isDis == \"turn\"){\r\n            if(gameApplication.soundManager.isOpen){\r\n                gameApplication.soundManager.setIsOpen(false);\r\n            }else{\r\n                gameApplication.soundManager.setIsOpen(true);\r\n            }\r\n        }\r\n        if(gameApplication.soundManager.isOpen){\r\n            this.musicBtn.spriteFrame = this.musicOn;\r\n        }else{\r\n            this.musicBtn.spriteFrame = this.musicOff;\r\n        }\r\n    },\r\n\r\n\r\n    init(){\r\n        if(this.missions == null || Object.keys(this.missions).length <= 0){\r\n            this.gameApplication.getMissions(function(results){\r\n                this.missions = results;\r\n                this.initContents();\r\n            }.bind(this));\r\n        }else{\r\n            this.initContents();\r\n        }\r\n\r\n        var self = this;\r\n        SDK().getScore(\"all\",function(score){\r\n            self.starts.getComponent(cc.Label).string = score.toString();\r\n        }.bind(this));\r\n        \r\n    },\r\n\r\n    initContents(){\r\n        this.hideAllItem();\r\n        var idx = 0;\r\n        this.missions.forEach(function(mission){\r\n            this.initMissionItem(mission,idx);\r\n            idx++;\r\n        }.bind(this));    \r\n    },\r\n\r\n    initMissionItem(mission,idx){\r\n        var cannonNode = cc.instantiate(this.missionItem);\r\n\r\n        cannonNode.parent = this.content;\r\n        cannonNode.active = true;\r\n        cannonNode.tag = idx;\r\n\r\n        var bgPath = (idx%6) + 1;\r\n\r\n        var starObj = cannonNode.getChildByName(\"star\");\r\n        var lockObj = cannonNode.getChildByName(\"lock\");\r\n        //set bg\r\n        // cannonNode.getChildByName(\"desc\").getComponent(cc.Sprite).spriteFrame = this.missionSpriteAtlas.getSpriteFrame(\"level_bg_\"+bgPath);\r\n\r\n        //set title\r\n        cannonNode.getChildByName(\"title\").getComponent(cc.Label).string = mission['title'];\r\n        cannonNode.getChildByName(\"bg\").getComponent(cc.Sprite).spriteFrame = this.missionSpriteAtlas.getSpriteFrame(\"mission_\"+bgPath);\r\n\r\n        // cannonNode.getChildByName(\"bg\").color = cc.hexToColor(mission['color']);\r\n        // cc.find(\"desc/val\",cannonNode).getComponent(cc.Label).string = mission['desc'];\r\n\r\n        var stars = mission['stars'];\r\n        var bid = mission['bid'];\r\n        var mid = mission['mid'];\r\n        var unlock_ad = mission['unlock_ad'];\r\n\r\n        this.missionNodes[bid+\"_\"+mid] = cannonNode;\r\n\r\n        SDK().getScore(bid+\"_\"+mid,function(score){\r\n            cc.find(\"unlock/count\",cannonNode).getComponent(cc.Label).string = score + \"/\"+stars;\r\n            cc.find(\"lock/count\",cannonNode).getComponent(cc.Label).string = score + \"/\"+stars;\r\n        })\r\n\r\n        if(unlock_ad <= 0){\r\n            cc.find(\"unlock\",cannonNode).active = true;\r\n            cc.find(\"lock\",cannonNode).active = false;\r\n        }else{\r\n            cc.find(\"unlock\",cannonNode).active = false;\r\n            cc.find(\"lock\",cannonNode).active = true;\r\n            var isUnlock = false;\r\n            SDK().getScore(\"unlock_\"+bid+\"_\"+mid,function(test){\r\n                if(test >= unlock_ad){\r\n                    isUnlock = true;\r\n                }\r\n\r\n                cc.find(\"lock/tip\",cannonNode).getComponent(cc.Label).string = \"watch \"+unlock_ad+\" videos\\n to unlock this new world\";\r\n                cc.find(\"lock/icon_play/val\",cannonNode).getComponent(cc.Label).string = test+\"/\"+unlock_ad;\r\n\r\n                cc.find(\"unlock\",cannonNode).active = isUnlock;\r\n                cc.find(\"lock\",cannonNode).active = !isUnlock;\r\n            }.bind(this));\r\n        }\r\n\r\n        //预加载关卡\r\n        var path = \"conf/level_list/level_\" + bid + '_' + mid;\r\n        this.gameApplication.getConf(path,null)\r\n\r\n    },\r\n\r\n    onWatchVideoBtnClicked(){\r\n        // cc.log(\"onWatchVideoBtnClicked\");\r\n        var self = this;\r\n        SDK().showVideoAd(function(isCompleted){\r\n            if(isCompleted){\r\n                //进入关卡\r\n                var bid = self.unlock_bid;\r\n                var mid = self.unlock_mid;\r\n                var unlock_ad= self.unlock_ad;\r\n\r\n                self.watched_ad++;\r\n\r\n                //更新node\r\n                var cannonNode = this.missionNodes[bid+\"_\"+mid];\r\n                cc.find(\"lock/icon_play/val\",cannonNode).getComponent(cc.Label).string = self.watched_ad+\"/\"+unlock_ad;\r\n\r\n                if(self.watched_ad >= unlock_ad){\r\n                    self.showLevelPanel(bid,mid);    \r\n                    cc.find(\"unlock\",cannonNode).active = true;\r\n                    cc.find(\"lock\",cannonNode).active = false;\r\n                }else{\r\n                    cc.find(\"unlock\",cannonNode).active = false;\r\n                    cc.find(\"lock\",cannonNode).active = true;\r\n                }\r\n\r\n\r\n                //记录这一关看广告次数\r\n                var param = {};\r\n                param[\"unlock_\"+bid+\"_\"+mid] = self.watched_ad;\r\n                SDK().setScore(param,null);\r\n\r\n\r\n            }else{\r\n                cc.log(\"播放视频广告失败\")\r\n                this.showNoAds();\r\n            }\r\n\r\n        }.bind(this));\r\n    },\r\n\r\n    // onCloseWatchVideoTipClicked(){\r\n    //     this.watchADTip.active = false;\r\n    // }, \r\n\r\n    onMissionItemClicked(event){\r\n        var self = this;\r\n        var target = event.target;\r\n        var targetBtn = target.getComponent(cc.Button);\r\n\r\n        targetBtn.interactable = false;\r\n        // target.getComponent(cc.Button).interactable = false;\r\n\r\n\r\n        var tag = parseInt(target.tag);\r\n        var mission = this.missions[tag];\r\n        // cc.log(mission)\r\n        if(mission == null){\r\n            return;\r\n        }\r\n\r\n        var bid = mission['bid'];\r\n        var mid = mission['mid'];\r\n        var unlock_ad = mission['unlock_ad'];\r\n        \r\n\r\n        if(unlock_ad <= 0){\r\n            this.showLevelPanel(bid,mid);\r\n            targetBtn.interactable = true;\r\n        }else{\r\n            var isUnlock = false;\r\n            SDK().getScore(\"unlock_\"+bid+\"_\"+mid,function(test){\r\n                if(test >= unlock_ad){\r\n                    isUnlock = true;\r\n                }\r\n\r\n                if(isUnlock){\r\n                    self.showLevelPanel(bid,mid);\r\n                    targetBtn.interactable = true;\r\n                }else{\r\n                    self.unlock_bid = bid;\r\n                    self.unlock_mid = mid;\r\n                    self.unlock_ad = unlock_ad;\r\n                    self.watched_ad = test;\r\n\r\n                    self.onWatchVideoBtnClicked();\r\n                    targetBtn.interactable = true;\r\n\r\n                }\r\n                \r\n            }.bind(this));\r\n\r\n\r\n        }\r\n\r\n        \r\n    },\r\n\r\n    hideAllItem(){\r\n        // cc.log(\"this.content.childrenCount:\"+this.content.childrenCount)\r\n        if(this.content.childrenCount > 0){\r\n            //如果有child，destroy\r\n            // cc.log(\"如果有child，destroy\");\r\n            this.content.children.forEach(function(n){\r\n                n.active = false;\r\n                n.destroy();\r\n            });\r\n        }\r\n    },\r\n\r\n    showLevelPanel(bid,mid){\r\n        this.gameApplication.openLevelView(bid,mid);\r\n        this.gameApplication.soundManager.playSound(\"btn_click\");\r\n    },\r\n\r\n    onBackBtnClicked(){\r\n        this.gameApplication.backToWelcome();\r\n        this.gameApplication.soundManager.playSound(\"btn_click\");\r\n    },\r\n\r\n\r\n    // update (dt) {},\r\n});\r\n"]}